window.__require=function t(i,e,n){function o(s,a){if(!e[s]){if(!i[s]){var c=s.split("/");if(c=c[c.length-1],!i[c]){var u="function"==typeof __require&&__require;if(!a&&u)return u(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var h=e[s]={exports:{}};i[s][0].call(h.exports,function(t){return o(i[s][1][t]||t)},h,h.exports,t,i,e,n)}return e[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({KSGame13:[function(t,i,e){"use strict";cc._RF.push(i,"7aa41FlecJJvprfogPdoYwz","KSGame13");var n,o=this&&this.__extends||(n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])})(t,i)},function(t,i){function e(){this.constructor=t}n(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}),r=this&&this.__decorate||function(t,i,e,n){var o,r=arguments.length,s=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,i,e,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(i,e,s):o(i,e))||s);return r>3&&s&&Object.defineProperty(i,e,s),s},s=this&&this.__awaiter||function(t,i,e,n){return new(e||(e=Promise))(function(o,r){function s(t){try{c(n.next(t))}catch(i){r(i)}}function a(t){try{c(n.throw(t))}catch(i){r(i)}}function c(t){var i;t.done?o(t.value):(i=t.value,i instanceof e?i:new e(function(t){t(i)})).then(s,a)}c((n=n.apply(t,i||[])).next())})},a=this&&this.__generator||function(t,i){var e,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(i){return c([t,i])}}function c(r){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=i.call(t,s)}catch(a){r=[6,a],n=0}finally{e=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var c=cc._decorator,u=c.ccclass,h=c.property,l=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.music=[],i.train=null,i.trainsp=null,i.imageNodes=[],i.title0=null,i.title1=null,i.title2=null,i.isDragging=!1,i.draggingNode=null,i.initialPositions=[],i.isSwapping=!1,i.isOtherImageMoved=!1,i.imageOrder=[],i.number0=0,i.number1=0,i.number2=0,i.NumofAns=0,i}return o(i,t),i.prototype.onLoad=function(){this.initTouchEvents(),this.saveInitialPositions(),this.initImageOrder(),this.RandomNumbers()},i.prototype.close=function(){this.node.destroy(),window.KS.Close()},i.prototype.initTouchEvents=function(){for(var t=this,i=function(i){var n=e.imageNodes[i];n.on(cc.Node.EventType.TOUCH_START,function(i){return t.onTouchStart(i,n)},e),n.on(cc.Node.EventType.TOUCH_MOVE,e.onTouchMove,e),n.on(cc.Node.EventType.TOUCH_END,e.onTouchEnd,e),n.on(cc.Node.EventType.TOUCH_CANCEL,e.onTouchEnd,e)},e=this,n=0;n<this.imageNodes.length;n++)i(n)},i.prototype.saveInitialPositions=function(){for(var t=0;t<this.imageNodes.length;t++)this.initialPositions[t]=this.imageNodes[t].position.clone()},i.prototype.initImageOrder=function(){for(var t=0;t<this.imageNodes.length;t++)this.imageOrder[t]=t},i.prototype.onTouchStart=function(t,i){this.isDragging||(this.isDragging=!0,this.draggingNode=i,this.draggingNode.zIndex=1,this.isOtherImageMoved=!1)},i.prototype.onTouchMove=function(t){var i=this;if(this.isDragging&&this.draggingNode&&!this.isSwapping){var e=t.getTouches()[0].getDelta();this.draggingNode.x+=e.x;for(var n=function(t){var e=o.imageNodes[t];e!==o.draggingNode&&o.draggingNode.position.sub(e.position).mag()<50&&(o.isSwapping=!0,cc.tween(o.draggingNode).to(.2,{position:e.position}).call(function(){i.isSwapping=!1;var n=i.imageNodes.indexOf(i.draggingNode);i.initialPositions[n]=i.draggingNode.position.clone(),i.initialPositions[t]=e.position.clone(),i.updateImageOrder(n,t)}).start(),cc.tween(e).to(.2,{x:o.initialPositions[o.imageNodes.indexOf(o.draggingNode)].x}).start(),o.isOtherImageMoved=!0)},o=this,r=0;r<this.imageNodes.length;r++)n(r)}},i.prototype.onTouchEnd=function(){if(this.isDragging&&this.draggingNode&&(this.isDragging=!1,this.draggingNode.zIndex=0,!this.isOtherImageMoved)){var t=this.initialPositions[this.imageNodes.indexOf(this.draggingNode)];this.draggingNode.position=t.clone()}},i.prototype.wait=function(t){return s(this,void 0,void 0,function(){return a(this,function(){return[2,new Promise(function(i){setTimeout(function(){i()},1e3*t)})]})})},i.prototype.updateImageOrder=function(){var t=this;this.imageOrder.sort(function(i,e){return t.imageNodes[i].x-t.imageNodes[e].x}),console.log(this.imageOrder),this.isTure()},i.prototype.RandomNumbers=function(){for(var t,i=[];i.length<3;){var e=Math.floor(9*Math.random())+1;i.includes(e)||i.push(e)}if(i.every(function(t,i,e){return 0===i||t>=e[i-1]}))for(var n=i.length-1;n>0;n--){var o=Math.floor(Math.random()*(n+1));t=[i[o],i[n]],i[n]=t[0],i[o]=t[1]}this.title0.string=i[0],this.title1.string=i[1],this.title2.string=i[2],this.number0=parseInt(this.title0.string),this.number1=parseInt(this.title1.string),this.number2=parseInt(this.title2.string)},i.prototype.isTure=function(){return s(this,void 0,void 0,function(){var t,i,e,n,o;return a(this,function(r){switch(r.label){case 0:for(t=[],o=0;o<3;o++)i=this.imageNodes[this.imageOrder[o]].getChildByName("New Label").getComponent(cc.Label).string,e=parseInt(i),t.push(e);for(console.log(t),n=!0,o=1;o<t.length;o++)if(t[o]<t[o-1]){n=!1;break}return n?(this.moveTrain(),[4,this.wait(4.5)]):[3,2];case 1:return r.sent(),this.createTrain(),this.RandomNumbers(),console.log("\u6570\u5b57\u662f\u4ece\u5c0f\u5230\u5927\u6392\u5217\u7684"),this.NumofAns++,[3,3];case 2:console.log("\u6570\u5b57\u4e0d\u662f\u4ece\u5c0f\u5230\u5927\u6392\u5217\u7684"),this.NumofAns=0,r.label=3;case 3:return console.log("\u8fde\u7eed\u7b54\u5bf9\u6b21\u6570: "+this.NumofAns),[2]}})})},i.prototype.moveTrain=function(){return s(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.trainsp.animation="car",cc.audioEngine.play(this.music[0],!1,1),cc.audioEngine.play(this.music[1],!1,1),[4,this.wait(1)];case 1:return t.sent(),cc.tween(this.train).to(3,{position:cc.v3(this.train.x-1400,this.train.y)},{easing:"sineInOut"}).start(),[2]}})})},i.prototype.createTrain=function(){return s(this,void 0,void 0,function(){return a(this,function(){return this.train.setPosition(2432.492,this.train.y),cc.audioEngine.play(this.music[1],!1,1),cc.tween(this.train).to(3,{position:cc.v3(this.train.x-1400,this.train.y)},{easing:"sineInOut"}).start(),[2]})})},r([h([cc.AudioClip])],i.prototype,"music",void 0),r([h(cc.Node)],i.prototype,"train",void 0),r([h(sp.Skeleton)],i.prototype,"trainsp",void 0),r([h(cc.Node)],i.prototype,"imageNodes",void 0),r([h(cc.Label)],i.prototype,"title0",void 0),r([h(cc.Label)],i.prototype,"title1",void 0),r([h(cc.Label)],i.prototype,"title2",void 0),r([u],i)}(cc.Component);e.default=l,cc._RF.pop()},{}]},{},["KSGame13"]);